package mx.com.icsp.util;

import java.util.Iterator;
import java.util.Scanner;

import mx.com.icsc.common.util.LogPattern;

import org.apache.log4j.Logger;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;

public class CreateXML {
	Logger log = Logger.getLogger(this.getClass());
	LogPattern logPattern = new LogPattern(Constants.domainCode,
			Constants.solutioNameCode, Constants.platform, Constants.tower,
			this.getClass().getName());

	// public static void main(String[] args){
	// String file = "a,b,c \n e,f,g";
	// createXml(file);
	// }

	public StringBuilder createXml(String file) {
		StringBuilder sb = null;
		int j = 0;
		if (file != null) {
			log.info("[CreateXML] File: " + file);
			sb = new StringBuilder();
			sb.append("<?xml version=\"1.0\" enconding=\"UTF-8\" ?>");
			sb.append("<rows>");
			Scanner scan = new Scanner(file);
			while (scan.hasNextLine()) {
				String oneLine = scan.nextLine();
				String[] tokens = oneLine.split(",");
				sb.append("<row id=\"").append(j).append("\">");
				for (int i = 0; i < tokens.length; i++) {
					sb.append("<cell>").append(tokens[i].trim())
							.append("</cell>");
				}
				sb.append("</row>");
				j++;
			}
			sb.append("</rows>");
			log.info("SB: " + sb.toString());
			return sb;
		}
		return sb;
	}

	public String createGrid(Sheet sheet) {
		Iterator<Row> rowIterator = sheet.iterator();
		StringBuilder sb = new StringBuilder();
		sb.append("<rows>");
		while (rowIterator.hasNext()) {
			Row row = rowIterator.next();
			Iterator<Cell> cellIterator = row.cellIterator();

			sb.append("<row>");

			int column = 0;
			while (cellIterator.hasNext()) {
				Cell cell = cellIterator.next();
				sb.append("<cell>");
				switch (cell.getCellType()) {
				case Cell.CELL_TYPE_BOOLEAN:
					sb.append(cell.getBooleanCellValue());
					break;
				case Cell.CELL_TYPE_NUMERIC:
					sb.append(cell.getNumericCellValue());
					break;
				case Cell.CELL_TYPE_STRING:
					String cellValue = cell.getStringCellValue();
					cellValue = cellValue.replace("\"", "\\\"");
					sb.append(cellValue);
					break;
				}

				String cellStringValue = null;
				int cellIntValue = 0;
				double cellDoubleValue = 0;
				switch (column) {
					case Constants.COLUMN_ID_LEDGER:
						cellIntValue = (int) cell.getNumericCellValue();
						sb.append(cellIntValue);
					break;
						
					case Constants.COLUMN_ASSET_TYPE:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_DESCRIPTION:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_BRAND:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_MODEL:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_SERIAL_NUMBER:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_MATERIAL:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_COLOR:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_SUPPLIER:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_DIRECTLY_RESPONSIBLE:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_GENERAL_MANAGER:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_BILL:
						cellStringValue = cell.getStringCellValue();
						cellStringValue = cellStringValue.replace("\"", "\\\"");
						sb.append(cellStringValue);
					break;
					
					case Constants.COLUMN_BILL_DATE:
					break;
					
					case Constants.COLUMN_PRICE:
						cellDoubleValue = cell.getNumericCellValue();
						sb.append(cellIntValue);
					break;
					
					case Constants.COLUMN_USE_DATE:
					break;
					
					case Constants.COLUMN_PLACE:
					break;
					
					case Constants.COLUMN_LOCATION:
					break;
					
					case Constants.COLUMN_GENERAL_LOCATION:
					break;
					
					case Constants.COLUMN_SECURE:
					break;
					
					case Constants.COLUMN_START;
					break;
				}

			}
			sb.append("</cell>");
			column++;

			sb.append("</row>");
		}
		sb.append("</rows>");

		return sb.toString();
	}
}
