function updateGuardGrid(directlyResponsible){
	try{	
		guard_grid.clearAndLoad("myAsset.do?method=getDirectlyResponsibleAsset&directlyResponsible="+directlyResponsible, function(){});
		
	}catch(err){
		showResponseXmlAlertError(err.message);
	}
}

function reloadDirectlyResponsibleSelect(){
	guard_form.reloadOptions("directlyResponsible", "myAsset.do?method=getDirectlyResponsible");
}

function getAssetGuardPdf(){
	guard_form.send("myReport.do?method=getGuardPdf","post",function(loader, response){
//		export_grid.toExcel("myReport.do?method=getAssetDbExcel&fileName="+fileName+"&extension="+extension);
		try{
			var responseCode = loader.xmlDoc.responseXML.childNodes[0].childNodes[1].childNodes[0].data;
			var responseMessage = loader.xmlDoc.responseXML.childNodes[0].childNodes[3].childNodes[0].data;
			if(responseCode == 0){
				showResponseXmlAlert(responseMessage);
				clearInsertForm();
				updateDHTMLXComponents();
			}else{
				showResponseXmlAlertError(responseMessage);
			}
		}catch(err){
			showResponseXmlAlertError(err.message);
		}
	});

}

var downloadFrame;
function downloadFile(url, params){
	if(downloadFrame == null){
		downloadFrame = document.createElement("iframe");
		downloadFrame.className = "download_iframe";
		downloadFrame.name = "download_frame";
		downloadFrame.border = downloadFrame.frameBorder = 0;
		document.body.appendChild(downloadFrame);		
	}
	
	var downloadForm = document.createElement("FORM");
	downloadForm.action = url;
	downloadForm.method = "POST";
	downloadForm.target = "download_frame";
	document.body.appendChild(downloadForm);
}