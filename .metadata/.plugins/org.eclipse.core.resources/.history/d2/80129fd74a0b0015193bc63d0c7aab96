var dhwin, import_excel_window, id="import_excel_window";
var myVault, mygrid;
var fileToGrid;

//function onLoad(){
//	createWindow();
//}

function importExcel(){
	try{
		dhwin = new dhtmlXWindows();
		import_excel_window = dhwin.createWindow({
			id : "exportExcelWindow",
			left : 0,
			right : 0,
			width : 500,
			height : 400,
			center : true,
			move : false,
			modal : true,
			resize : false,
			caption : "Importar Excel",
			header : true
		});
		
		import_excel_window.button("park").hide();
		import_excel_window.button("minmax").hide();
		
//		var import_excel_layout = import_excel_window.attachLayout("1C");
		
		myVault = import_excel_window.attachVault({
			uploadUrl:  "myImport.do?method=importExcel&header=true"
		});
		
		myVault.attachEvent("onUploadFile", function(file, extra){
			if(file.uploaded){
				showResponseXmlAlert("<b>"+extra.info+"</b>: " + file.name);
				report_grid.loadXMLString(extra.param);
			}else{
				showResponseXmlAlertError("<b>Ocurrio un error cargar el archvio</b>: "+file.name + " " +extra.info)
			}
		});
		
		myVault.attachEvent("onUploadFail", function(file, extra){
			showResponseXmlAlertError("<b>Ocurrio un error cargar el archvio</b>: "+file.name + " " +extra.info)			
		});
		
		var import_excel_toolbar = import_excel_window.attachToolbar({
			icon_path: "imgs/dhtmlx/dhtmlxToolbar/",
			xml: "xml/import/import_excel_toolbar.xml"
		});
		
		import_excel_toolbar.attachEvent("onClick", function(name){
			window[name]();
		});

	}catch(e){
		alert("Error: "+ e.toString());
	}
}


