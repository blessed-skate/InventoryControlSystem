var dhwin, ulwindow, ulLayout, id="ulwindow";
var myVault, mygrid;
var fileToGrid;

//function onLoad(){
//	createWindow();
//}

function importExcel(){
	try{
		dhwin = new dhtmlXWindows();
		ulwindow = dhwin.createWindow({
			id : "exportExcelWindow",
			left : 0,
			right : 0,
			width : 500,
			height : 400,
			center : true,
			move : false,
			modal : true,
			resize : false,
			caption : "Importar Excel",
			header : true
		});
		
		ulwindow.button('park').hide();
		ulwindow.button('minmax').hide();
		
		import_excel_layout = ulwindow.attachLayout('1C');
		
		import_excel_layout.attachToolbar({
			icon_path: "imgs/dhtmlx/dhtmlxToolbar/",
			xml: "xml/import/import_excel_toolbar.xml" 
		});

		myVault = ulwindow.attachVault({
			uploadUrl:  "myImport.do?method=importExcel"      // html4/html5 upload url
		});
		
		myVault.attachEvent("onUploadFile", function(file, extra){
			if(file.uploaded){
				showResponseXmlAlert("<b>"+extra.info+"</b>: " + file.name);
				report_grid.loadXMLString(extra.param);
			}else{
				showResponseXmlAlertError("<b>Ocurrio un error cargar el archvio</b>: "+file.name + " " +extra.info)
			}
		});
		
		myVault.attachEvent("onUploadFail", function(file, extra){
			showResponseXmlAlertError("<b>Ocurrio un error cargar el archvio</b>: "+file.name + " " +extra.info)			
		});

	}catch(e){
		alert("Error: "+ e.toString());
	}
}


